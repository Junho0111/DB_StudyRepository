# SQL - 데이터 관리

### 데이터베이스 관리 (Database Control)

| 기능 | 명령어 (Syntax) | 사용 예시 (Example) |
| :--- | :--- | :--- |
| **생성** | `CREATE DATABASE [DB이름];` | `CREATE DATABASE my_shop;` |
| **사용** | `USE [DB이름];` | `USE my_shop;` |
| **목록 확인** | `SHOW DATABASES;` | `SHOW DATABASES;` |
| **삭제** | `DROP DATABASE [DB이름];` | `DROP DATABASE my_shop;` |

<br>

### 테이블 구조 정의 및 변경 (Table DDL)

| 기능 | 명령어 (Syntax) | 사용 예시 (Example) |
| :--- | :--- | :--- |
| **생성** | `CREATE TABLE [이름] ( [컬럼] [타입] [제약] );` | <br>`CREATE TABLE customers ( customer_id INT PRIMARY KEY, ... );` |
| **구조 확인** | `DESC [테이블명];` | `DESC customers;` |
| **목록 확인** | `SHOW TABLES;` | `SHOW TABLES;` |
| **컬럼 추가** | `ALTER TABLE [명] ADD COLUMN [컬럼] [타입];` | <br>`ALTER TABLE customers ADD COLUMN phone VARCHAR(20);` |
| **삭제** | `DROP TABLE [테이블명];` | <br>`DROP TABLE customers;` |

<br>

### 데이터 조작 (DML - CRUD)

데이터 관리의 가장 핵심적인 4개 작업입니다.

#### **Create (데이터 추가)**

* **설명**: 테이블에 새로운 행(Row)을 삽입합니다. 


* **예시**:

```sql
-- 모든 컬럼 또는 특정 컬럼을 지정하여 삽입
INSERT INTO customers (name, email, password, address) 
VALUES ('김철수', 'chul@example.com', '1234', '서울시'); 

```

<br>

#### **Read (데이터 조회)**

* **설명**: 저장된 데이터를 불러옵니다. 


* **예시**:

```sql
SELECT * FROM customers; -- 모든 고객 정보 조회
SELECT name, email FROM customers; -- 특정 정보만 선택 조회

```

<br>

#### **Update (데이터 수정)**

* **설명**: 기존 데이터를 변경합니다. **WHERE 절이 없으면 모든 데이터가 바뀌므로 주의하세요.** 


* **예시**:

```sql
UPDATE customers 
SET address = '경기도' 
WHERE customer_id = 1; -- 특정 ID를 가진 행만 수정

```

<br>

#### **Delete (데이터 삭제)**

* **설명**: 특정 행을 삭제합니다. 


* **예시**:

```sql
DELETE FROM customers 
WHERE customer_id = 1; -- 특정 ID를 가진 행만 삭제

```

---

### 주요 데이터 타입 (Data Types)

* **숫자 (Numeric)**
* `INT`: 일반적인 정수 (4바이트). 


* `DECIMAL(M, D)`: 정확한 소수점 계산이 필요한 금융 데이터용.


* **문자열 (String)**
* `VARCHAR(n)`: **가변 길이.** 입력된 만큼만 공간 사용 (가장 추천). 


* `CHAR(n)`: **고정 길이.** 길이가 일정한 데이터(주민번호 등)용.


* **날짜/시간 (Date & Time)**
* `DATE`: 날짜만 저장 (`YYYY-MM-DD`).
* `DATETIME`: 날짜+시간 그대로 저장. 2038년 제한이 없어 권장됨. 


* `TIMESTAMP`: 타임존 자동 변환 기능 제공. 

---

### 핵심 제약 조건 (Constraints)

| 제약 조건 | 설명 |
| :--- | :--- |
| **PRIMARY KEY** | 테이블 내에서 행을 유일하게 식별하는 키 (중복/NULL 불가). |
| **AUTO_INCREMENT** | 데이터를 삽입할 때 숫자를 1씩 자동으로 증가시켜 부여. |
| **NOT NULL** | 빈 값(NULL)을 허용하지 않음. 반드시 값을 입력해야 함. |
| **UNIQUE** | 해당 컬럼에 중복된 값을 허용하지 않음 (예: 이메일). |
| **DEFAULT** | 값을 입력하지 않았을 때 자동으로 들어갈 기본값 설정. |
| **CURRENT_TIMESTAMP** | 현재 시간을 기본값으로 자동 입력 (주로 가입/수정 시각에 사용). |

<br>

### 시나리오별 사용 예시 (Scenario & Example)

* **테이블 생성 (DDL)**: "회원 가입 시스템을 위한 기본 회원 테이블 설계"
```sql
-- PK, 자동 증가, 기본값, 고정 길이 등 다양한 제약 조건을 적용함
CREATE TABLE members (
    member_id INT AUTO_INCREMENT PRIMARY KEY, -- 고유 번호 자동 부여
    username VARCHAR(50) NOT NULL UNIQUE,     -- 중복 불가, 필수 입력
    status CHAR(1) DEFAULT 'Y',               -- 고정 길이 'Y' 또는 'N'
    joined_at DATETIME DEFAULT NOW()          -- 현재 시간 자동 기록
);

```
<br>

* **데이터 추가 및 수정 (INSERT & UPDATE)**: "신규 상품 등록 후 가격 오기재 수정"
```sql
-- 데이터 추가
INSERT INTO products (name, price, stock) 
VALUES ('기계식 키보드', 150000, 10);

-- 데이터 수정 (WHERE 절로 대상 특정 필수)
UPDATE products 
SET price = 145000 
WHERE name = '기계식 키보드';

```
<br>

* **조건부 데이터 삭제 (DELETE)**: "재고가 없고 등록된 지 오래된 상품 데이터 정리"
```sql
-- 특정 조건을 만족하는 행만 안전하게 삭제함
DELETE FROM products 
WHERE stock = 0 AND created_at < '2025-01-01';

```
<br>

* **테이블 구조 변경 (ALTER)**: "기존 고객 테이블에 마케팅 수신 동의 여부 컬럼 추가"
```sql
-- 기존 데이터를 유지하면서 새로운 컬럼을 맨 뒤에 붙임
ALTER TABLE customers 
ADD COLUMN marketing_agree CHAR(1) DEFAULT 'N';

```