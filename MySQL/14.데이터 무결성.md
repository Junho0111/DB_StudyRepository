# SQL - 데이터 무결성 (Data Integrity)

### 1. 데이터 무결성이란?

데이터 무결성은 데이터베이스에 저장된 데이터가 **정확성, 일관성, 유효성**을 유지하는 것을 말함. 잘못된 데이터(예: 이름 없는 고객, 존재하지 않는 상품의 주문 등)가 들어오지 못하도록 방어막을 치는 것이 핵심.

<br>

### 2. 제약 조건의 종류 
| 제약 조건 | 설명 | 실무 활용 예시 |
| --- | --- | --- |
| **NOT NULL** | 컬럼에 NULL(빈 값) 저장을 허용하지 않음. | 고객 이름, 상품명, 가격 등 필수 정보 |
| **UNIQUE** | 중복된 값을 허용하지 않음. (NULL은 중복 허용 가능) | 이메일 주소, 로그인 아이디, 전화번호 |
| **PRIMARY KEY (기본 키)** | 테이블 내에서 행을 유일하게 식별. (NOT NULL + UNIQUE) | 고객 ID, 상품 ID, 주문 번호 |
| **FOREIGN KEY (외래 키)** | 다른 테이블과의 관계를 정의하고 참조 무결성 유지. | 주문 테이블의 '고객 ID' (고객 테이블 참조) |
| **DEFAULT** | 값을 입력하지 않았을 때 자동으로 들어갈 기본값. | 가입일(`NOW()`), 주문 상태('접수완료') |

<br>

### 3. 참조 무결성 (Referential Integrity)

외래 키(FK)를 통해 유지되는 무결성.

* **규칙**: 외래 키 값은 참조하는 테이블의 기본 키(PK)에 반드시 존재하거나 NULL이어야함.
* **효과**: 존재하지 않는 고객이 주문을 하거나, 존재하지 않는 상품이 판매되는 데이터 오류를 원천 차단함.

<br>

### 4. 제약 조건 설정 및 관리 (문법)

| 기능 | 명령어 (Syntax) |
| --- | --- |
| **테이블 생성 시** | `CREATE TABLE 명 ( 컬럼 타입 PRIMARY KEY, ... );` |
| **생성 후 추가** | `ALTER TABLE 명 ADD CONSTRAINT [제약명] [제약종류](컬럼);` |
| **제약 조건 삭제** | `ALTER TABLE 명 DROP [CONSTRAINT/INDEX/PRIMARY KEY] ...;` |

<br>

### 5. 실무 포인트

* **데이터베이스가 마지막 보루다**: 애플리케이션(Java/Spring) 코드에서도 데이터 검증을 하지만, 최종적으로 데이터베이스에서 제약 조건을 걸어주어야 시스템의 데이터가 깨지지 않는다고 강조합니다.
* **PK는 필수**: 모든 테이블에는 비즈니스적인 의미가 없더라도 `AUTO_INCREMENT`를 활용한 PK를 반드시 생성할 것을 권장합니다.
* **외래 키의 양날의 검**: 외래 키는 데이터 무결성을 보장하지만, 대규모 서비스에서는 데이터 변경 시 성능 저하나 운영상 불편함(데이터 삭제가 까다로움)을 초래할 수 있어 신중하게 설계해야함.